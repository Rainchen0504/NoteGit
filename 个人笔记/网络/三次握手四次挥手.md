**<font color=pink>TCP的三次握手和四次挥手实质上就是TCP通信的连接和断开</font>**。

## 三次握手：

TCP协议位于传输层，作用是提供可靠的字节流服务，这个过程会对每次发送的数据量进行跟踪和协商，确保数据段发送和接收同步，根据所接收到的数据量而确认数据发送、接收完毕后何时撤销联系，并建立连接。

1. 第1次握手：客户端发送一个带有SYN标识的数据包给服务端；
2. 第2次握手：服务端接收成功后，回传一个带有SYN/ACK标志的数据包传递确认信息，表示可以收到；
3. 第3次握手：客户端再回传一个带有ACK标志的数据包，表示知道可以接收，握手结束；

其中，SYN标志位数置为1，表示建立TCP连接；ACK标志表示验证字段。



## 四次挥手：

终止TCP连接，就是断开一个TCP连接时，需要客户端和服务端共发送4个包以确认连接的断开。

1. 第1次挥手：客户端发送一个FIN，用来关闭客户端到服务端的数据传送，客户端进入`FIN_WAIT_`1`状态；`
2. 2次挥手：服务端收到FIN后，发送一个ACK给客户端，确认序号为收到序号+1（与SYN相同，一个FIN占用一个序号），服务端进入`CLOSE_WAIT`状态；
3. 第3次挥手：服务端发送一个FIN，用来关闭服务端到客户端的数据传送，服务端进入`LAST_ACK`状态；
4. 第4次挥手：客户端收到FIN后，客户端进入`TIME_WAIT`状态，接着发送一个ACK给服务端，确认序号为收到序号+1，服务端进入`CLOSED`状态，完成四次挥手；

其中，FIN标志位数置为1，表示断开TCP连接。



## 时序示意图

<img src="https://raw.githubusercontent.com/Rainchen0504/picture/master/202304170922305.png" alt="img" style="zoom:67%"/>

